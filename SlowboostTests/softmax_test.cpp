#include "common.hpp"
#include "helpers.hpp"
#include "ops/Softmax.hpp"
#include "gtest/gtest.h"

TEST(SpecificationCorrectness, SoftmaxTest)
{
	Matrix red_points = xt::random::randn<double>({ 50, 2 }) - 2 * xt::ones<double>({ 50, 2 });
	Matrix blue_points = xt::random::randn<double>({ 50, 2 }) + 2 * xt::ones<double>({ 50, 2 });

	/*auto all_points = xt::vstack(xtuple(red_points, blue_points));
	auto sm = op<Softmax>(debug_var(all_points));
	auto output = sm->execute();

	TO_VARIABLE(output);

	EXPECT_TRUE(
		xt::allclose(xt::xarray<double>{ { 1.78068485e-02, 1.54428601e-02 }, { 1.05221168e-02, 2.17599480e-03 },
						 { 5.07184971e-03, 5.94449919e-03 }, { 1.86986935e-02, 1.09486386e-02 },
						 { 4.46098250e-03, 2.57669239e-03 }, { 5.22860234e-03, 7.78031829e-03 },
						 { 3.32400326e-03, 8.67995279e-03 }, { 1.01286534e-02, 5.87759610e-02 },
						 { 2.86966435e-03, 2.93500256e-03 }, { 6.42014245e-03, 2.04367195e-03 },
						 { 1.26356406e-02, 1.52928006e-02 }, { 6.34403507e-03, 2.76384007e-02 },
						 { 2.61712182e-01, 3.16142221e-02 }, { 6.00766035e-03, 7.41472239e-03 },
						 { 2.78999612e-02, 2.55279444e-03 }, { 4.04751511e-03, 3.54580303e-02 },
						 { 1.14467568e-02, 4.45209487e-03 }, { 1.45496941e-02, 4.19259563e-02 },
						 { 3.44500586e-02, 7.72997698e-03 }, { 3.22965419e-03, 4.10150411e-02 },
						 { 1.83552186e-02, 1.15879465e-03 }, { 6.42958480e-02, 2.79401672e-03 },
						 { 5.35641525e-02, 4.08147812e-03 }, { 3.24505820e-02, 2.48530682e-02 },
						 { 1.20179624e-02, 1.24073421e-02 }, { 8.98642248e-03, 1.24460218e-02 },
						 { 1.60214547e-03, 2.77780538e-02 }, { 6.65528389e-03, 7.47846087e-03 },
						 { 6.26150089e-03, 3.63704467e-02 }, { 5.85755308e-02, 2.25339209e-02 },
						 { 2.62882529e-02, 3.42676036e-02 }, { 2.59938627e-03, 3.23000441e-02 },
						 { 4.80129451e-03, 1.02249394e-01 }, { 2.01275569e-02, 2.30202110e-02 },
						 { 1.45073519e-02, 2.42217585e-03 }, { 7.43570528e-03, 1.01051566e-02 },
						 { 9.10525592e-03, 1.35050280e-03 }, { 1.32057823e-02, 2.99072013e-03 },
						 { 1.35586788e-03, 3.04569465e-02 }, { 1.11677245e-02, 4.70192774e-02 },
						 { 8.91674372e-03, 1.56240412e-02 }, { 2.51988919e-02, 3.09457890e-02 },
						 { 1.16455345e-02, 1.04077705e-02 }, { 5.63329518e-03, 1.47685516e-02 },
						 { 4.21213872e-02, 1.74040299e-02 }, { 1.84457773e-02, 4.41574791e-03 },
						 { 1.33521019e-02, 4.65864185e-03 }, { 3.88133355e-03, 2.05159352e-02 },
						 { 4.32840026e-03, 5.45649637e-03 }, { 1.19338441e-02, 8.96631657e-02 },
						 { 5.68793985e-04, 9.98470608e-05 }, { 2.65244063e-04, 1.85481438e-04 },
						 { 1.32229407e-03, 1.45288802e-04 }, { 5.01967405e-04, 9.07452755e-05 },
						 { 4.55829893e-05, 9.15714781e-05 }, { 9.19621479e-05, 5.53117720e-04 },
						 { 1.45254718e-04, 1.00416542e-03 }, { 1.16396987e-04, 3.65567185e-04 },
						 { 2.12188434e-04, 1.14177961e-04 }, { 9.35790257e-05, 1.82832478e-04 },
						 { 3.92533321e-05, 3.40653018e-05 }, { 1.16704379e-04, 1.20167249e-04 },
						 { 3.43842730e-05, 2.63698094e-04 }, { 1.03622328e-04, 7.36475180e-05 },
						 { 9.99192129e-05, 1.89611301e-04 }, { 4.32305035e-04, 6.93945920e-05 },
						 { 1.86022999e-04, 4.24566200e-05 }, { 1.70709733e-03, 8.07727026e-05 },
						 { 8.04611849e-05, 3.87890234e-04 }, { 1.05608520e-04, 5.63202063e-05 },
						 { 8.83832333e-04, 2.17349486e-04 }, { 6.03601948e-05, 7.86181285e-05 },
						 { 2.14063318e-04, 4.42940481e-05 }, { 1.07137606e-04, 1.02952592e-04 },
						 { 3.94547674e-04, 2.61497690e-04 }, { 1.49653478e-04, 7.02990122e-04 },
						 { 1.69131863e-04, 2.65585971e-04 }, { 3.92417380e-04, 5.35030931e-04 },
						 { 1.91396618e-04, 2.85465756e-04 }, { 5.02657241e-05, 1.07309327e-04 },
						 { 5.73325874e-04, 2.60525701e-03 }, { 2.23526275e-04, 2.81548369e-04 },
						 { 9.00328479e-05, 7.90788178e-04 }, { 2.88878698e-05, 6.11714050e-04 },
						 { 1.37479086e-04, 6.45632697e-04 }, { 1.13710437e-03, 2.93908555e-04 },
						 { 2.45070630e-05, 5.09815354e-04 }, { 7.29048736e-05, 8.76863571e-05 },
						 { 6.79624550e-05, 3.08488456e-04 }, { 7.56831411e-04, 3.35261427e-04 },
						 { 1.08469018e-04, 1.50497312e-04 }, { 6.49262456e-04, 5.18353831e-04 },
						 { 7.72685404e-05, 4.09856374e-04 }, { 9.42568019e-05, 3.25532549e-05 },
						 { 4.34371314e-05, 2.02235439e-04 }, { 2.29336296e-04, 3.84115856e-04 },
						 { 4.72638185e-04, 4.27976583e-05 }, { 5.61002747e-04, 4.08458405e-04 },
						 { 3.72387075e-05, 7.45294806e-05 }, { 6.22297401e-05, 2.13152445e-04 } },
			variable));*/
}
